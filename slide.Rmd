---
title: |
  | oyoyo
  | hogehoge研修
author: "iotsuka"
date: '2023-06-12'
output:
  beamer_presentation:
    theme: default
    latex_engine: lualatex
    keep_tex: true
    includes:
      in_header: header.tex
    fig_caption: true
    incremental: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(
  dev = "cairo_pdf",
  dev.args = list(family = "Meiryo")
)
```


```{r include=FALSE}
library(tidyverse)
library(readxl)
library(viridis)
library(gt)
library(ragg)
library(ggthemes)
library(bayestestR)
```


# a beautiful true story

\Huge

\begin{itemize}
\item[\textbullet] 予算の会議\pause
\item[\textbullet] ある事業について\pause
\item[\textbullet] どんな成果?
\end{itemize}

# a beautiful true story

\IfFileExists{kids.jpg}{\centering\includegraphics{kids.jpg}}{\relax}

# evidence-based policy-making
\Huge

\begin{itemize}
\item[\textbullet] 思いだけでは進まない
\pause
\item[\textbullet] 客観的な根拠
\end{itemize}
\pause
\vspace*{-30pt}
\hspace*{18pt}\rotatebox{13}{\scalebox{2}{\textcolor{gray}{dataの活用!}}}

# case study 1


# case study 1

\Huge


\rotatebox{0}{\scalebox{2}{\textcolor{gray}{\begin{tabular}{l}病気の検査\end{tabular}}}}

\vspace*{-48pt}
\pause
\rotatebox{20}{\scalebox{3.8}{\textcolor{red!30}{\begin{tabular}{l}\fbox{\fbox{陽性}}\end{tabular}}}}

<!-- # case study 1 -->

<!-- \Huge -->

<!-- 検査を受けました\pause{\textrightarrow{}\,\,{}陽性!!!} -->

# case study 1

\LARGE

\begin{itemize}
\item どんな病気??
\pause
\item 　\textbullet{}\hspace{2pt}人口の1\%がこの病気
\pause
\item
\item どんな検査??
\pause
\item 　\textbullet{}\hspace{2pt}病気なら90\%の確率で陽性
\pause
\item 　\textbullet{}\hspace{2pt}病気でないなら90\%の確率で陰性
\end{itemize}

# case study 1

\Huge
\raggedleft
\raisebox{-20pt}{\rotatebox{20}{\scalebox{1.4}{\textcolor{red!60}{\fbox{\fbox{陽性}}}}}}判定のあなたが\par
\vspace*{-20pt}\pause
\scalebox{1}{\textcolor{red!60}{ほんとうに}}\par
\pause
\scalebox{1.4}{\textcolor{red!60}{病気}}である確率は？



```{r}
prevalence <- 1    #有病率
sensitivity <-  90  #感度
specificity <-  90  #特異度

precision <- function(x, y, z){
  x * y / (x * y + (100 - x) * (100 - z))
}

accuracy <- function(x, y, z){
  (x * y + (100 - x) * z) / 10000
}
```






# case study 1

\scalebox{.88}{%
\begin{tikzpicture}
 \tikzset{block/.style={rectangle, text width=25mm, text centered, rounded corners, minimum height=1.5cm}};
%\draw [help lines] (-6,0) grid (6,6);%(0,0)から(10,4)までの"細線の方眼"
\node[block,fill=gray!10] (population) at (0,7) {population\\1,000人};
\pause
\node[block,fill=gray!10] (sick) at (-3.5,4) {sick\\10人};
\draw [->, very thick,color=black!60] (population) to[out=-90, in=60] node[auto=right] {有病率$1\%$} (sick); 
\pause
\node[block,fill=gray!10] (not_sick) at (3.5,4) {not sick\\990人};
\draw [->,very thick,color=black!60] (population) to[out=-90, in=120]  node[auto=left] {$99\%$} (not_sick); 
\pause
\node[block,fill=red!10,draw=red] (true_positive) at (-5,) {true positive\\9人};
\draw [->,very thick,,color=black!60] (sick) to[out=-90, in=90]  node[auto=right] {感度$90\%$} (true_positive); 
\pause
\node[block,fill=gray!10] (false_negative) at (-2,1) {false negative\\1人};
\draw [->,very thick,,color=black!60] (sick) to[out=-90, in=90]  node[auto=left] {$10\%$} (false_negative); 
\pause
\node[block,fill=gray!10] (true_negative) at (2,1) {true negative\\891人};
\draw [->,very thick,,color=black!60] (not_sick) to[out=-90, in=90]  node[auto=right] {特異度$90\%$} (true_negative); 
\pause
\node[block,fill=red!10,draw=red] (false_positive) at (5,1) {false positive\\99人};
\draw [->,very thick,,color=black!60] (not_sick) to[out=-90, in=90]  node[auto=left] {$10\%$} (false_positive); 
 \end{tikzpicture}%
}

# case study 1
\begin{center}\Huge               
\[
 \scalebox{1.4}{$\frac{9}{\;9 + 99\;}=0.08333$}
\]
\end{center}



# case study 2 --- world war II

\raggedleft

\IfFileExists{survivorship_bias.png}{\scalebox{.9}{\includegraphics{survivorship_bias.png}}}{\relax}


\tiny

\raggedleft
Martin Grandjean(vector), McGeddon(picture), Cameron Moll(concept)

\vspace{-5pt}

This work is licensed under the Creative Commons Attribution-Share Alike 4.0 International license.

\pause


\Huge
\vspace{-120pt}
\raisebox{120pt}{\rotatebox{10}{\textcolor{black}{\scalebox{1.2}{どこを}}}}

\vspace{-130pt}
\raisebox{130pt}{\rotatebox{10}{\textcolor{black}{\scalebox{1.2}{補強?}}}}

# case study 3

\Huge

\begin{itemize}
\item[\textbullet] ある町
\pause
\item[\textbullet] 4つの学校
\pause
\item[\textbullet] 同じテスト
\end{itemize}

# case study 3

\Huge

\begin{itemize}
\item[\textbullet] 家庭での学習時間
\pause
\item[\textbullet] 正答率
\end{itemize}
\pause
\vspace*{-55pt}
\rotatebox{20}{\scalebox{2}{\textcolor{gray}{どんな関係?}}}


# plot



```{r echo=FALSE}
set.seed(2)
data <- simulate_simpson(n = 200, groups = 4, r = 0.3, group_prefix = "school_") |> 
  mutate(V2 = (V2 + 9) * 10, V1 = .5 * V1 + 1) |> 
  rename("study_time" = V1, "grade" = V2, "school" = Group) |> 
  mutate(study_time = study_time*.7) |> 
  mutate(grade = if_else(grade > 100, 100, grade))
#####################
piyopiyo <- function(){
  ggplot(data, aes(x = study_time, y = grade)) +
    geom_point(alpha = .7, size = 3) +
    labs(x = "学習時間(h)", y = "正答率")
}
```





```{r}
piyopiyo()
```


# case study 3



```{r echo=FALSE, message=FALSE}
piyopiyo() +
  geom_smooth(method = "lm", se = FALSE)
```


# case study 3

\IfFileExists{./letsnotsee.jpg}{\centering\includegraphics[width=\textwidth]{./letsnotsee.jpg}}{\relax}


# case study 3



```{r echo=FALSE}
set.seed(1)
piyopiyo() +
  aes(colour = school) +
  ggthemes::scale_colour_few(guide = "none")
```




# case study 3



```{r echo=FALSE}
piyopiyo() +
  aes(colour = school) +
  scale_color_few(guide = "none") +
  facet_wrap(~school)
```

# case study 3



```{r echo=FALSE}
set.seed(1)
piyopiyo() +
  aes(colour = school) +
  scale_color_few(guide = "none") +
  facet_wrap(~school) +
  geom_smooth(method = "lm", se = FALSE)
```

# case study 3



```{r echo=FALSE}
piyopiyo() +
  aes(colour = school) +
  scale_color_few(guide = "none") +
  geom_smooth(method = "lm", se = FALSE)
```

# case study 3



```{r echo=FALSE, message=FALSE}
piyopiyo() +
  aes(colour = school) +
  scale_color_few(guide = "none") +
  geom_smooth(method = "lm", se = FALSE) +
  geom_smooth(data = data, 
              aes(study_time, grade), 
              colour = "black", 
              method = "lm", se = FALSE)
```


# case study 3
\LARGE

\begin{itemize}
\item[\textbullet] 全体では\par
「勉強するほど成績がさがる」
\bigskip\pause
\item[\textbullet] 学校ごとでは\par
「勉強するほど成績があがる」
\end{itemize}

# case study 3 --- Simpson's Paradox
\LARGE

全体と個々のグループでの傾向が異なる

\normalsize

# tebiki

\vspace*{-20pt}
\IfFileExists{./tebiki.jpg}{\centering\scalebox{.9}{\rotatebox{-90}{\includegraphics[width=\textheight]{tebiki.jpg}}}}{\relax}


# Sir Winston Spencer Churchill

\raggedleft\Huge

\raisebox{100pt}{\rotatebox{30}{\textcolor{white}{\scalebox{1.2}{Brevity}}}}　　
\IfFileExists{Sir_Winston_Churchil.jpg}{\scalebox{.75}{\includegraphics{Sir_Winston_Churchil.jpg}}}{\relax}


\tiny

\raggedleft
The Roaring Lion(Yousuf Karsh)
\vspace{-5pt}

This work is licensed under the Creative Commons Attribution 2.0 Generic License.

# Sir Winston Spencer Churchill

\raggedleft\Huge

\raisebox{100pt}{\rotatebox{30}{\textcolor{black}{\scalebox{1.2}{Brevity}}}}　　
\IfFileExists{Sir_Winston_Churchil.jpg}{\scalebox{.75}{\includegraphics{Sir_Winston_Churchil.jpg}}}{\relax}


\tiny

\raggedleft
The Roaring Lion(Yousuf Karsh)
\vspace{-5pt}

This work is licensed under the Creative Commons Attribution 2.0 Generic License.




# Brevity

\centering
\vspace*{-21.5pt}
\IfFileExists{churchill_memo.jpg}{\scalebox{1.025}{\includegraphics{churchill_memo.jpg}}}{\relax}


# Brevity
\Large

To do our work, we all have to read a mass of papers. 
Nearly all of them are far too long.\par

\vfill
\Huge

\rotatebox{15}{\scalebox{1.6}{\textcolor{white}{\begin{tabular}{l}大量の書類\\長すぎる\end{tabular}}}}

\vfill

# Brevity
\Large

To do our work, we all have to read \textcolor{olive}{a mass of papers}. 
Nearly all of them are \textcolor{olive}{far too long}.\par


\vfill
\Huge

\rotatebox{15}{\scalebox{1.6}{\textcolor{olive}{\begin{tabular}{l}大量の書類\\長すぎる\end{tabular}}}}

\vfill

# Brevity
\Large


This wastes time, 
while energy has to be spent in looking for the essential points.\par

\vfill\Huge

\rotatebox{15}{\scalebox{1.6}{\textcolor{white}{\begin{tabular}{l}時間のむだ\\要点がわからない\end{tabular}}}}

\vfill
\mbox{}

# Brevity
\Large


This \textcolor{olive}{wastes time}, 
while energy has to be spent in looking for \textcolor{olive}{the essential points}.\par

\vfill\Huge

\rotatebox{15}{\scalebox{1.6}{\textcolor{olive}{\begin{tabular}{l}時間のむだ\\要点がわからない\end{tabular}}}}

\vfill


# Brevity
\Large


I ask my colleagues and their staffs to see to it that their Reports are shorter.


\vfill\Huge

\rotatebox{15}{\scalebox{1.6}{\textcolor{white}{\begin{tabular}{l}報告書を短く\end{tabular}}}}

\vfill

# Brevity
\Large


I ask my colleagues and their staffs to see to it that \textcolor{olive}{their Reports are shorter}.


\vfill\Huge

\rotatebox{15}{\scalebox{1.6}{\textcolor{olive}{\begin{tabular}{l}報告書を短く\end{tabular}}}}

\vfill


# Brevity
\Huge



\begin{itemize}
\item \scalebox{1.3}{歯切れよくいいきれ}
  \begin{itemize}
  \item \pause
  \item \scalebox{2}{\textbullet{}\myCrossedOut{red!60!gray}{冗長ないいまわし}}
  \item \scalebox{2}{\textbullet{}乱暴な表現でよし}
\end{itemize}
\end{itemize}


# what is important

\Huge

-  \textbullet{}\hspace{2pt} 本質
\bigskip
-  \textbullet{}\hspace{2pt} 体裁
\bigskip
-  \textbullet{}\hspace{2pt} スピード感



# tebiki

\vspace*{-20pt}
\IfFileExists{./tebiki.jpg}{\centering\scalebox{.9}{\rotatebox{-90}{\includegraphics[width=\textheight]{tebiki.jpg}}}}{\relax}


# quiz

\Huge

\begin{enumerate}
\item \scalebox{1.2}{又は or または}\pause
\item \scalebox{1.2}{子供 or 子ども}\pause
\item \scalebox{1.2}{コンピュータ}\par
\scalebox{1.2}{or コンピューター}\pause
\item \scalebox{1.2}{手引 or 手引き}\pause
\end{enumerate}

# manual

\IfFileExists{./seisaku_homu01.png}{\scalebox{1.05}{\includegraphics{seisaku_homu01.png}}}{\relax}

# manual

\IfFileExists{./seisaku_homu03.png}{\scalebox{1.4018}{\includegraphics{seisaku_homu03.png}}}{\relax}



# tebiki

\vspace*{-20pt}
\IfFileExists{./tebiki.jpg}{\centering\scalebox{.9}{\rotatebox{-90}{\includegraphics[width=\textheight]{tebiki.jpg}}}}{\relax}

# summing up

\Huge

\begin{itemize}
\item  \scalebox{1.4}{根拠}\pause
\item  \scalebox{1.4}{簡潔さ}\pause
\item  \scalebox{1.4}{スピード感}
\end{itemize}


# ??
\Huge

\scalebox{1.4}{\textcolor{black}{\begin{tabular}{l}私の夢は\\子供を笑顔にしたい\end{tabular}}}

# May this sign be displayed forever!



\vspace*{-4pt}
\IfFileExists{./bento.jpg}{\centering\scalebox{.85}{\includegraphics[width=\textheight]{bento.jpg}}}{\relax}



# last but not least



```{r cars, echo = TRUE}
piyopiyo()
```



